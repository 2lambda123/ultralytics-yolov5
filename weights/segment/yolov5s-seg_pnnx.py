import os
import numpy as np
import tempfile, zipfile
import torch
import torch.nn as nn
import torch.nn.functional as F
try:
    import torchvision
except:
    pass

class Model(nn.Module):
    def __init__(self):
        super(Model, self).__init__()

        self.model_0_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=3, kernel_size=(6,6), out_channels=32, padding=(2,2), padding_mode='zeros', stride=(2,2))
        self.model_0_act = nn.SiLU()
        self.model_1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=32, kernel_size=(3,3), out_channels=64, padding=(1,1), padding_mode='zeros', stride=(2,2))
        self.model_1_act = nn.SiLU()
        self.model_2_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=64, kernel_size=(1,1), out_channels=32, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_2_cv1_act = nn.SiLU()
        self.model_2_m_0_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=32, kernel_size=(1,1), out_channels=32, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_2_m_0_cv1_act = nn.SiLU()
        self.model_2_m_0_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=32, kernel_size=(3,3), out_channels=32, padding=(1,1), padding_mode='zeros', stride=(1,1))
        self.model_2_m_0_cv2_act = nn.SiLU()
        self.model_2_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=64, kernel_size=(1,1), out_channels=32, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_2_cv2_act = nn.SiLU()
        self.model_2_cv3_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=64, kernel_size=(1,1), out_channels=64, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_2_cv3_act = nn.SiLU()
        self.model_3_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=64, kernel_size=(3,3), out_channels=128, padding=(1,1), padding_mode='zeros', stride=(2,2))
        self.model_3_act = nn.SiLU()
        self.model_4_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(1,1), out_channels=64, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_4_cv1_act = nn.SiLU()
        self.model_4_m_0_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=64, kernel_size=(1,1), out_channels=64, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_4_m_0_cv1_act = nn.SiLU()
        self.model_4_m_0_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=64, kernel_size=(3,3), out_channels=64, padding=(1,1), padding_mode='zeros', stride=(1,1))
        self.model_4_m_0_cv2_act = nn.SiLU()
        self.model_4_m_1_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=64, kernel_size=(1,1), out_channels=64, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_4_m_1_cv1_act = nn.SiLU()
        self.model_4_m_1_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=64, kernel_size=(3,3), out_channels=64, padding=(1,1), padding_mode='zeros', stride=(1,1))
        self.model_4_m_1_cv2_act = nn.SiLU()
        self.model_4_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(1,1), out_channels=64, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_4_cv2_act = nn.SiLU()
        self.model_4_cv3_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_4_cv3_act = nn.SiLU()
        self.model_5_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(3,3), out_channels=256, padding=(1,1), padding_mode='zeros', stride=(2,2))
        self.model_5_act = nn.SiLU()
        self.model_6_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_6_cv1_act = nn.SiLU()
        self.model_6_m_0_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_6_m_0_cv1_act = nn.SiLU()
        self.model_6_m_0_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(3,3), out_channels=128, padding=(1,1), padding_mode='zeros', stride=(1,1))
        self.model_6_m_0_cv2_act = nn.SiLU()
        self.model_6_m_1_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_6_m_1_cv1_act = nn.SiLU()
        self.model_6_m_1_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(3,3), out_channels=128, padding=(1,1), padding_mode='zeros', stride=(1,1))
        self.model_6_m_1_cv2_act = nn.SiLU()
        self.model_6_m_2_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_6_m_2_cv1_act = nn.SiLU()
        self.model_6_m_2_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(3,3), out_channels=128, padding=(1,1), padding_mode='zeros', stride=(1,1))
        self.model_6_m_2_cv2_act = nn.SiLU()
        self.model_6_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_6_cv2_act = nn.SiLU()
        self.model_6_cv3_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(1,1), out_channels=256, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_6_cv3_act = nn.SiLU()
        self.model_7_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(3,3), out_channels=512, padding=(1,1), padding_mode='zeros', stride=(2,2))
        self.model_7_act = nn.SiLU()
        self.model_8_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=512, kernel_size=(1,1), out_channels=256, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_8_cv1_act = nn.SiLU()
        self.model_8_m_0_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(1,1), out_channels=256, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_8_m_0_cv1_act = nn.SiLU()
        self.model_8_m_0_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(3,3), out_channels=256, padding=(1,1), padding_mode='zeros', stride=(1,1))
        self.model_8_m_0_cv2_act = nn.SiLU()
        self.model_8_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=512, kernel_size=(1,1), out_channels=256, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_8_cv2_act = nn.SiLU()
        self.model_8_cv3_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=512, kernel_size=(1,1), out_channels=512, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_8_cv3_act = nn.SiLU()
        self.model_9_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=512, kernel_size=(1,1), out_channels=256, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_9_cv1_act = nn.SiLU()
        self.model_9_m = nn.MaxPool2d(ceil_mode=False, dilation=(1,1), kernel_size=(5,5), padding=(2,2), return_indices=False, stride=(1,1))
        self.pnnx_unique_0 = nn.MaxPool2d(ceil_mode=False, dilation=(1,1), kernel_size=(5,5), padding=(2,2), return_indices=False, stride=(1,1))
        self.pnnx_unique_1 = nn.MaxPool2d(ceil_mode=False, dilation=(1,1), kernel_size=(5,5), padding=(2,2), return_indices=False, stride=(1,1))
        self.model_9_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=1024, kernel_size=(1,1), out_channels=512, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_9_cv2_act = nn.SiLU()
        self.model_10_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=512, kernel_size=(1,1), out_channels=256, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_10_act = nn.SiLU()
        self.model_11 = nn.Upsample(mode='nearest', scale_factor=(2.000000,2.000000), size=None)
        self.model_13_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=512, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_13_cv1_act = nn.SiLU()
        self.model_13_m_0_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_13_m_0_cv1_act = nn.SiLU()
        self.model_13_m_0_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(3,3), out_channels=128, padding=(1,1), padding_mode='zeros', stride=(1,1))
        self.model_13_m_0_cv2_act = nn.SiLU()
        self.model_13_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=512, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_13_cv2_act = nn.SiLU()
        self.model_13_cv3_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(1,1), out_channels=256, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_13_cv3_act = nn.SiLU()
        self.model_14_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_14_act = nn.SiLU()
        self.model_15 = nn.Upsample(mode='nearest', scale_factor=(2.000000,2.000000), size=None)
        self.model_17_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(1,1), out_channels=64, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_17_cv1_act = nn.SiLU()
        self.model_17_m_0_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=64, kernel_size=(1,1), out_channels=64, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_17_m_0_cv1_act = nn.SiLU()
        self.model_17_m_0_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=64, kernel_size=(3,3), out_channels=64, padding=(1,1), padding_mode='zeros', stride=(1,1))
        self.model_17_m_0_cv2_act = nn.SiLU()
        self.model_17_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(1,1), out_channels=64, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_17_cv2_act = nn.SiLU()
        self.model_17_cv3_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_17_cv3_act = nn.SiLU()
        self.model_18_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(3,3), out_channels=128, padding=(1,1), padding_mode='zeros', stride=(2,2))
        self.model_18_act = nn.SiLU()
        self.model_20_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_20_cv1_act = nn.SiLU()
        self.model_20_m_0_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_20_m_0_cv1_act = nn.SiLU()
        self.model_20_m_0_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(3,3), out_channels=128, padding=(1,1), padding_mode='zeros', stride=(1,1))
        self.model_20_m_0_cv2_act = nn.SiLU()
        self.model_20_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(1,1), out_channels=128, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_20_cv2_act = nn.SiLU()
        self.model_20_cv3_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(1,1), out_channels=256, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_20_cv3_act = nn.SiLU()
        self.model_21_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(3,3), out_channels=256, padding=(1,1), padding_mode='zeros', stride=(2,2))
        self.model_21_act = nn.SiLU()
        self.model_23_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=512, kernel_size=(1,1), out_channels=256, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_23_cv1_act = nn.SiLU()
        self.model_23_m_0_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(1,1), out_channels=256, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_23_m_0_cv1_act = nn.SiLU()
        self.model_23_m_0_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(3,3), out_channels=256, padding=(1,1), padding_mode='zeros', stride=(1,1))
        self.model_23_m_0_cv2_act = nn.SiLU()
        self.model_23_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=512, kernel_size=(1,1), out_channels=256, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_23_cv2_act = nn.SiLU()
        self.model_23_cv3_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=512, kernel_size=(1,1), out_channels=512, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_23_cv3_act = nn.SiLU()
        self.model_24_proto_cv1_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(3,3), out_channels=128, padding=(1,1), padding_mode='zeros', stride=(1,1))
        self.model_24_proto_cv1_act = nn.SiLU()
        self.model_24_proto_upsample = nn.Upsample(mode='nearest', scale_factor=(2.000000,2.000000), size=None)
        self.model_24_proto_cv2_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(3,3), out_channels=128, padding=(1,1), padding_mode='zeros', stride=(1,1))
        self.model_24_proto_cv2_act = nn.SiLU()
        self.model_24_proto_cv3_conv = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(1,1), out_channels=32, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_24_proto_cv3_act = nn.SiLU()
        self.model_24_m_0 = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=128, kernel_size=(1,1), out_channels=351, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_24_m_1 = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=256, kernel_size=(1,1), out_channels=351, padding=(0,0), padding_mode='zeros', stride=(1,1))
        self.model_24_m_2 = nn.Conv2d(bias=True, dilation=(1,1), groups=1, in_channels=512, kernel_size=(1,1), out_channels=351, padding=(0,0), padding_mode='zeros', stride=(1,1))

        archive = zipfile.ZipFile('weights/segment/yolov5s-seg.pnnx.bin', 'r')
        self.model_0_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.0.conv.bias', (32), 'float32')
        self.model_0_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.0.conv.weight', (32,3,6,6), 'float32')
        self.model_1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.1.conv.bias', (64), 'float32')
        self.model_1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.1.conv.weight', (64,32,3,3), 'float32')
        self.model_2_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.2.cv1.conv.bias', (32), 'float32')
        self.model_2_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.2.cv1.conv.weight', (32,64,1,1), 'float32')
        self.model_2_m_0_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.2.m.0.cv1.conv.bias', (32), 'float32')
        self.model_2_m_0_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.2.m.0.cv1.conv.weight', (32,32,1,1), 'float32')
        self.model_2_m_0_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.2.m.0.cv2.conv.bias', (32), 'float32')
        self.model_2_m_0_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.2.m.0.cv2.conv.weight', (32,32,3,3), 'float32')
        self.model_2_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.2.cv2.conv.bias', (32), 'float32')
        self.model_2_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.2.cv2.conv.weight', (32,64,1,1), 'float32')
        self.model_2_cv3_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.2.cv3.conv.bias', (64), 'float32')
        self.model_2_cv3_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.2.cv3.conv.weight', (64,64,1,1), 'float32')
        self.model_3_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.3.conv.bias', (128), 'float32')
        self.model_3_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.3.conv.weight', (128,64,3,3), 'float32')
        self.model_4_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.4.cv1.conv.bias', (64), 'float32')
        self.model_4_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.4.cv1.conv.weight', (64,128,1,1), 'float32')
        self.model_4_m_0_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.4.m.0.cv1.conv.bias', (64), 'float32')
        self.model_4_m_0_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.4.m.0.cv1.conv.weight', (64,64,1,1), 'float32')
        self.model_4_m_0_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.4.m.0.cv2.conv.bias', (64), 'float32')
        self.model_4_m_0_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.4.m.0.cv2.conv.weight', (64,64,3,3), 'float32')
        self.model_4_m_1_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.4.m.1.cv1.conv.bias', (64), 'float32')
        self.model_4_m_1_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.4.m.1.cv1.conv.weight', (64,64,1,1), 'float32')
        self.model_4_m_1_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.4.m.1.cv2.conv.bias', (64), 'float32')
        self.model_4_m_1_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.4.m.1.cv2.conv.weight', (64,64,3,3), 'float32')
        self.model_4_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.4.cv2.conv.bias', (64), 'float32')
        self.model_4_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.4.cv2.conv.weight', (64,128,1,1), 'float32')
        self.model_4_cv3_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.4.cv3.conv.bias', (128), 'float32')
        self.model_4_cv3_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.4.cv3.conv.weight', (128,128,1,1), 'float32')
        self.model_5_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.5.conv.bias', (256), 'float32')
        self.model_5_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.5.conv.weight', (256,128,3,3), 'float32')
        self.model_6_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.6.cv1.conv.bias', (128), 'float32')
        self.model_6_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.6.cv1.conv.weight', (128,256,1,1), 'float32')
        self.model_6_m_0_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.6.m.0.cv1.conv.bias', (128), 'float32')
        self.model_6_m_0_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.6.m.0.cv1.conv.weight', (128,128,1,1), 'float32')
        self.model_6_m_0_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.6.m.0.cv2.conv.bias', (128), 'float32')
        self.model_6_m_0_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.6.m.0.cv2.conv.weight', (128,128,3,3), 'float32')
        self.model_6_m_1_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.6.m.1.cv1.conv.bias', (128), 'float32')
        self.model_6_m_1_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.6.m.1.cv1.conv.weight', (128,128,1,1), 'float32')
        self.model_6_m_1_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.6.m.1.cv2.conv.bias', (128), 'float32')
        self.model_6_m_1_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.6.m.1.cv2.conv.weight', (128,128,3,3), 'float32')
        self.model_6_m_2_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.6.m.2.cv1.conv.bias', (128), 'float32')
        self.model_6_m_2_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.6.m.2.cv1.conv.weight', (128,128,1,1), 'float32')
        self.model_6_m_2_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.6.m.2.cv2.conv.bias', (128), 'float32')
        self.model_6_m_2_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.6.m.2.cv2.conv.weight', (128,128,3,3), 'float32')
        self.model_6_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.6.cv2.conv.bias', (128), 'float32')
        self.model_6_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.6.cv2.conv.weight', (128,256,1,1), 'float32')
        self.model_6_cv3_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.6.cv3.conv.bias', (256), 'float32')
        self.model_6_cv3_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.6.cv3.conv.weight', (256,256,1,1), 'float32')
        self.model_7_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.7.conv.bias', (512), 'float32')
        self.model_7_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.7.conv.weight', (512,256,3,3), 'float32')
        self.model_8_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.8.cv1.conv.bias', (256), 'float32')
        self.model_8_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.8.cv1.conv.weight', (256,512,1,1), 'float32')
        self.model_8_m_0_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.8.m.0.cv1.conv.bias', (256), 'float32')
        self.model_8_m_0_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.8.m.0.cv1.conv.weight', (256,256,1,1), 'float32')
        self.model_8_m_0_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.8.m.0.cv2.conv.bias', (256), 'float32')
        self.model_8_m_0_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.8.m.0.cv2.conv.weight', (256,256,3,3), 'float32')
        self.model_8_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.8.cv2.conv.bias', (256), 'float32')
        self.model_8_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.8.cv2.conv.weight', (256,512,1,1), 'float32')
        self.model_8_cv3_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.8.cv3.conv.bias', (512), 'float32')
        self.model_8_cv3_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.8.cv3.conv.weight', (512,512,1,1), 'float32')
        self.model_9_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.9.cv1.conv.bias', (256), 'float32')
        self.model_9_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.9.cv1.conv.weight', (256,512,1,1), 'float32')
        self.model_9_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.9.cv2.conv.bias', (512), 'float32')
        self.model_9_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.9.cv2.conv.weight', (512,1024,1,1), 'float32')
        self.model_10_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.10.conv.bias', (256), 'float32')
        self.model_10_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.10.conv.weight', (256,512,1,1), 'float32')
        self.model_13_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.13.cv1.conv.bias', (128), 'float32')
        self.model_13_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.13.cv1.conv.weight', (128,512,1,1), 'float32')
        self.model_13_m_0_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.13.m.0.cv1.conv.bias', (128), 'float32')
        self.model_13_m_0_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.13.m.0.cv1.conv.weight', (128,128,1,1), 'float32')
        self.model_13_m_0_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.13.m.0.cv2.conv.bias', (128), 'float32')
        self.model_13_m_0_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.13.m.0.cv2.conv.weight', (128,128,3,3), 'float32')
        self.model_13_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.13.cv2.conv.bias', (128), 'float32')
        self.model_13_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.13.cv2.conv.weight', (128,512,1,1), 'float32')
        self.model_13_cv3_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.13.cv3.conv.bias', (256), 'float32')
        self.model_13_cv3_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.13.cv3.conv.weight', (256,256,1,1), 'float32')
        self.model_14_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.14.conv.bias', (128), 'float32')
        self.model_14_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.14.conv.weight', (128,256,1,1), 'float32')
        self.model_17_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.17.cv1.conv.bias', (64), 'float32')
        self.model_17_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.17.cv1.conv.weight', (64,256,1,1), 'float32')
        self.model_17_m_0_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.17.m.0.cv1.conv.bias', (64), 'float32')
        self.model_17_m_0_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.17.m.0.cv1.conv.weight', (64,64,1,1), 'float32')
        self.model_17_m_0_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.17.m.0.cv2.conv.bias', (64), 'float32')
        self.model_17_m_0_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.17.m.0.cv2.conv.weight', (64,64,3,3), 'float32')
        self.model_17_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.17.cv2.conv.bias', (64), 'float32')
        self.model_17_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.17.cv2.conv.weight', (64,256,1,1), 'float32')
        self.model_17_cv3_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.17.cv3.conv.bias', (128), 'float32')
        self.model_17_cv3_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.17.cv3.conv.weight', (128,128,1,1), 'float32')
        self.model_18_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.18.conv.bias', (128), 'float32')
        self.model_18_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.18.conv.weight', (128,128,3,3), 'float32')
        self.model_20_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.20.cv1.conv.bias', (128), 'float32')
        self.model_20_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.20.cv1.conv.weight', (128,256,1,1), 'float32')
        self.model_20_m_0_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.20.m.0.cv1.conv.bias', (128), 'float32')
        self.model_20_m_0_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.20.m.0.cv1.conv.weight', (128,128,1,1), 'float32')
        self.model_20_m_0_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.20.m.0.cv2.conv.bias', (128), 'float32')
        self.model_20_m_0_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.20.m.0.cv2.conv.weight', (128,128,3,3), 'float32')
        self.model_20_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.20.cv2.conv.bias', (128), 'float32')
        self.model_20_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.20.cv2.conv.weight', (128,256,1,1), 'float32')
        self.model_20_cv3_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.20.cv3.conv.bias', (256), 'float32')
        self.model_20_cv3_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.20.cv3.conv.weight', (256,256,1,1), 'float32')
        self.model_21_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.21.conv.bias', (256), 'float32')
        self.model_21_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.21.conv.weight', (256,256,3,3), 'float32')
        self.model_23_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.23.cv1.conv.bias', (256), 'float32')
        self.model_23_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.23.cv1.conv.weight', (256,512,1,1), 'float32')
        self.model_23_m_0_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.23.m.0.cv1.conv.bias', (256), 'float32')
        self.model_23_m_0_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.23.m.0.cv1.conv.weight', (256,256,1,1), 'float32')
        self.model_23_m_0_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.23.m.0.cv2.conv.bias', (256), 'float32')
        self.model_23_m_0_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.23.m.0.cv2.conv.weight', (256,256,3,3), 'float32')
        self.model_23_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.23.cv2.conv.bias', (256), 'float32')
        self.model_23_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.23.cv2.conv.weight', (256,512,1,1), 'float32')
        self.model_23_cv3_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.23.cv3.conv.bias', (512), 'float32')
        self.model_23_cv3_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.23.cv3.conv.weight', (512,512,1,1), 'float32')
        self.model_24_proto_cv1_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.24.proto.cv1.conv.bias', (128), 'float32')
        self.model_24_proto_cv1_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.24.proto.cv1.conv.weight', (128,128,3,3), 'float32')
        self.model_24_proto_cv2_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.24.proto.cv2.conv.bias', (128), 'float32')
        self.model_24_proto_cv2_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.24.proto.cv2.conv.weight', (128,128,3,3), 'float32')
        self.model_24_proto_cv3_conv.bias = self.load_pnnx_bin_as_parameter(archive, 'model.24.proto.cv3.conv.bias', (32), 'float32')
        self.model_24_proto_cv3_conv.weight = self.load_pnnx_bin_as_parameter(archive, 'model.24.proto.cv3.conv.weight', (32,128,1,1), 'float32')
        self.model_24_m_0.bias = self.load_pnnx_bin_as_parameter(archive, 'model.24.m.0.bias', (351), 'float32')
        self.model_24_m_0.weight = self.load_pnnx_bin_as_parameter(archive, 'model.24.m.0.weight', (351,128,1,1), 'float32')
        self.model_24_m_1.bias = self.load_pnnx_bin_as_parameter(archive, 'model.24.m.1.bias', (351), 'float32')
        self.model_24_m_1.weight = self.load_pnnx_bin_as_parameter(archive, 'model.24.m.1.weight', (351,256,1,1), 'float32')
        self.model_24_m_2.bias = self.load_pnnx_bin_as_parameter(archive, 'model.24.m.2.bias', (351), 'float32')
        self.model_24_m_2.weight = self.load_pnnx_bin_as_parameter(archive, 'model.24.m.2.weight', (351,512,1,1), 'float32')
        self.pnnx_53_pnnx_53 = self.load_pnnx_bin_as_parameter(archive, 'pnnx_53.pnnx_53', (1,3,20,20,2), 'float32')
        self.pnnx_54_pnnx_54 = self.load_pnnx_bin_as_parameter(archive, 'pnnx_54.pnnx_54', (1,3,20,20,2), 'float32')
        self.pnnx_55_pnnx_55 = self.load_pnnx_bin_as_parameter(archive, 'pnnx_55.pnnx_55', (1,3,40,40,2), 'float32')
        self.pnnx_56_pnnx_56 = self.load_pnnx_bin_as_parameter(archive, 'pnnx_56.pnnx_56', (1,3,40,40,2), 'float32')
        self.pnnx_58_pnnx_58 = self.load_pnnx_bin_as_parameter(archive, 'pnnx_58.pnnx_58', (1,3,80,80,2), 'float32')
        self.pnnx_60_pnnx_60 = self.load_pnnx_bin_as_parameter(archive, 'pnnx_60.pnnx_60', (1,3,80,80,2), 'float32')
        self.pnnx_fold_604_pnnx_fold_604 = self.load_pnnx_bin_as_parameter(archive, 'pnnx_fold_604.pnnx_fold_604', (), 'float32')
        self.pnnx_fold_643_pnnx_fold_643 = self.load_pnnx_bin_as_parameter(archive, 'pnnx_fold_643.pnnx_fold_643', (), 'float32')
        self.pnnx_fold_682_pnnx_fold_682 = self.load_pnnx_bin_as_parameter(archive, 'pnnx_fold_682.pnnx_fold_682', (), 'float32')
        archive.close()

    def load_pnnx_bin_as_parameter(self, archive, key, shape, dtype, requires_grad=True):
        return nn.Parameter(self.load_pnnx_bin_as_tensor(archive, key, shape, dtype), requires_grad)

    def load_pnnx_bin_as_tensor(self, archive, key, shape, dtype):
        _, tmppath = tempfile.mkstemp()
        tmpf = open(tmppath, 'wb')
        with archive.open(key) as keyfile:
            tmpf.write(keyfile.read())
        tmpf.close()
        m = np.memmap(tmppath, dtype=dtype, mode='r', shape=shape).copy()
        os.remove(tmppath)
        return torch.from_numpy(m)

    def forward(self, v_0):
        v_1 = self.model_0_conv(v_0)
        v_2 = self.model_0_act(v_1)
        v_3 = self.model_1_conv(v_2)
        v_4 = self.model_1_act(v_3)
        v_5 = self.model_2_cv1_conv(v_4)
        v_6 = self.model_2_cv1_act(v_5)
        v_7 = self.model_2_m_0_cv1_conv(v_6)
        v_8 = self.model_2_m_0_cv1_act(v_7)
        v_9 = self.model_2_m_0_cv2_conv(v_8)
        v_10 = self.model_2_m_0_cv2_act(v_9)
        v_11 = (v_6 + v_10)
        v_12 = self.model_2_cv2_conv(v_4)
        v_13 = self.model_2_cv2_act(v_12)
        v_14 = torch.cat((v_11, v_13), dim=1)
        v_15 = self.model_2_cv3_conv(v_14)
        v_16 = self.model_2_cv3_act(v_15)
        v_17 = self.model_3_conv(v_16)
        v_18 = self.model_3_act(v_17)
        v_19 = self.model_4_cv1_conv(v_18)
        v_20 = self.model_4_cv1_act(v_19)
        v_21 = self.model_4_m_0_cv1_conv(v_20)
        v_22 = self.model_4_m_0_cv1_act(v_21)
        v_23 = self.model_4_m_0_cv2_conv(v_22)
        v_24 = self.model_4_m_0_cv2_act(v_23)
        v_25 = (v_20 + v_24)
        v_26 = self.model_4_m_1_cv1_conv(v_25)
        v_27 = self.model_4_m_1_cv1_act(v_26)
        v_28 = self.model_4_m_1_cv2_conv(v_27)
        v_29 = self.model_4_m_1_cv2_act(v_28)
        v_30 = (v_25 + v_29)
        v_31 = self.model_4_cv2_conv(v_18)
        v_32 = self.model_4_cv2_act(v_31)
        v_33 = torch.cat((v_30, v_32), dim=1)
        v_34 = self.model_4_cv3_conv(v_33)
        v_35 = self.model_4_cv3_act(v_34)
        v_36 = self.model_5_conv(v_35)
        v_37 = self.model_5_act(v_36)
        v_38 = self.model_6_cv1_conv(v_37)
        v_39 = self.model_6_cv1_act(v_38)
        v_40 = self.model_6_m_0_cv1_conv(v_39)
        v_41 = self.model_6_m_0_cv1_act(v_40)
        v_42 = self.model_6_m_0_cv2_conv(v_41)
        v_43 = self.model_6_m_0_cv2_act(v_42)
        v_44 = (v_39 + v_43)
        v_45 = self.model_6_m_1_cv1_conv(v_44)
        v_46 = self.model_6_m_1_cv1_act(v_45)
        v_47 = self.model_6_m_1_cv2_conv(v_46)
        v_48 = self.model_6_m_1_cv2_act(v_47)
        v_49 = (v_44 + v_48)
        v_50 = self.model_6_m_2_cv1_conv(v_49)
        v_51 = self.model_6_m_2_cv1_act(v_50)
        v_52 = self.model_6_m_2_cv2_conv(v_51)
        v_53 = self.model_6_m_2_cv2_act(v_52)
        v_54 = (v_49 + v_53)
        v_55 = self.model_6_cv2_conv(v_37)
        v_56 = self.model_6_cv2_act(v_55)
        v_57 = torch.cat((v_54, v_56), dim=1)
        v_58 = self.model_6_cv3_conv(v_57)
        v_59 = self.model_6_cv3_act(v_58)
        v_60 = self.model_7_conv(v_59)
        v_61 = self.model_7_act(v_60)
        v_62 = self.model_8_cv1_conv(v_61)
        v_63 = self.model_8_cv1_act(v_62)
        v_64 = self.model_8_m_0_cv1_conv(v_63)
        v_65 = self.model_8_m_0_cv1_act(v_64)
        v_66 = self.model_8_m_0_cv2_conv(v_65)
        v_67 = self.model_8_m_0_cv2_act(v_66)
        v_68 = (v_63 + v_67)
        v_69 = self.model_8_cv2_conv(v_61)
        v_70 = self.model_8_cv2_act(v_69)
        v_71 = torch.cat((v_68, v_70), dim=1)
        v_72 = self.model_8_cv3_conv(v_71)
        v_73 = self.model_8_cv3_act(v_72)
        v_74 = self.model_9_cv1_conv(v_73)
        v_75 = self.model_9_cv1_act(v_74)
        v_76 = self.model_9_m(v_75)
        v_77 = self.pnnx_unique_0(v_76)
        v_78 = self.pnnx_unique_1(v_77)
        v_79 = torch.cat((v_75, v_76, v_77, v_78), dim=1)
        v_80 = self.model_9_cv2_conv(v_79)
        v_81 = self.model_9_cv2_act(v_80)
        v_82 = self.model_10_conv(v_81)
        v_83 = self.model_10_act(v_82)
        v_84 = self.model_11(v_83)
        v_85 = torch.cat((v_84, v_59), dim=1)
        v_86 = self.model_13_cv1_conv(v_85)
        v_87 = self.model_13_cv1_act(v_86)
        v_88 = self.model_13_m_0_cv1_conv(v_87)
        v_89 = self.model_13_m_0_cv1_act(v_88)
        v_90 = self.model_13_m_0_cv2_conv(v_89)
        v_91 = self.model_13_m_0_cv2_act(v_90)
        v_92 = self.model_13_cv2_conv(v_85)
        v_93 = self.model_13_cv2_act(v_92)
        v_94 = torch.cat((v_91, v_93), dim=1)
        v_95 = self.model_13_cv3_conv(v_94)
        v_96 = self.model_13_cv3_act(v_95)
        v_97 = self.model_14_conv(v_96)
        v_98 = self.model_14_act(v_97)
        v_99 = self.model_15(v_98)
        v_100 = torch.cat((v_99, v_35), dim=1)
        v_101 = self.model_17_cv1_conv(v_100)
        v_102 = self.model_17_cv1_act(v_101)
        v_103 = self.model_17_m_0_cv1_conv(v_102)
        v_104 = self.model_17_m_0_cv1_act(v_103)
        v_105 = self.model_17_m_0_cv2_conv(v_104)
        v_106 = self.model_17_m_0_cv2_act(v_105)
        v_107 = self.model_17_cv2_conv(v_100)
        v_108 = self.model_17_cv2_act(v_107)
        v_109 = torch.cat((v_106, v_108), dim=1)
        v_110 = self.model_17_cv3_conv(v_109)
        v_111 = self.model_17_cv3_act(v_110)
        v_112 = self.model_18_conv(v_111)
        v_113 = self.model_18_act(v_112)
        v_114 = torch.cat((v_113, v_98), dim=1)
        v_115 = self.model_20_cv1_conv(v_114)
        v_116 = self.model_20_cv1_act(v_115)
        v_117 = self.model_20_m_0_cv1_conv(v_116)
        v_118 = self.model_20_m_0_cv1_act(v_117)
        v_119 = self.model_20_m_0_cv2_conv(v_118)
        v_120 = self.model_20_m_0_cv2_act(v_119)
        v_121 = self.model_20_cv2_conv(v_114)
        v_122 = self.model_20_cv2_act(v_121)
        v_123 = torch.cat((v_120, v_122), dim=1)
        v_124 = self.model_20_cv3_conv(v_123)
        v_125 = self.model_20_cv3_act(v_124)
        v_126 = self.model_21_conv(v_125)
        v_127 = self.model_21_act(v_126)
        v_128 = torch.cat((v_127, v_83), dim=1)
        v_129 = self.model_23_cv1_conv(v_128)
        v_130 = self.model_23_cv1_act(v_129)
        v_131 = self.model_23_m_0_cv1_conv(v_130)
        v_132 = self.model_23_m_0_cv1_act(v_131)
        v_133 = self.model_23_m_0_cv2_conv(v_132)
        v_134 = self.model_23_m_0_cv2_act(v_133)
        v_135 = self.model_23_cv2_conv(v_128)
        v_136 = self.model_23_cv2_act(v_135)
        v_137 = torch.cat((v_134, v_136), dim=1)
        v_138 = self.model_23_cv3_conv(v_137)
        v_139 = self.model_23_cv3_act(v_138)
        v_140 = self.pnnx_53_pnnx_53
        v_141 = self.pnnx_54_pnnx_54
        v_142 = self.pnnx_55_pnnx_55
        v_143 = self.pnnx_56_pnnx_56
        v_144 = self.pnnx_58_pnnx_58
        v_145 = self.pnnx_60_pnnx_60
        v_146 = self.model_24_proto_cv1_conv(v_111)
        v_147 = self.model_24_proto_cv1_act(v_146)
        v_148 = self.model_24_proto_upsample(v_147)
        v_149 = self.model_24_proto_cv2_conv(v_148)
        v_150 = self.model_24_proto_cv2_act(v_149)
        v_151 = self.model_24_proto_cv3_conv(v_150)
        v_152 = self.model_24_proto_cv3_act(v_151)
        v_153 = self.model_24_m_0(v_111)
        v_154 = v_153.view(1, 3, 117, 80, 80)
        v_155 = torch.permute(input=v_154, dims=(0,1,3,4,2))
        v_156 = v_155.contiguous(memory_format=torch.contiguous_format)
        v_157, v_158, v_159, v_160 = torch.split(tensor=v_156, dim=4, split_size_or_sections=(2,2,81,32))
        v_161 = F.sigmoid(input=v_157)
        v_162 = self.pnnx_fold_604_pnnx_fold_604
        v_163 = (((v_161 * 2) + v_145) * v_162)
        v_164 = F.sigmoid(input=v_158)
        v_165 = (torch.pow((v_164 * 2), 2) * v_144)
        v_166 = F.sigmoid(input=v_159)
        v_167 = torch.cat((v_163, v_165, v_166, v_160), dim=4)
        v_168 = self.model_24_m_1(v_125)
        v_169 = v_168.view(1, 3, 117, 40, 40)
        v_170 = torch.permute(input=v_169, dims=(0,1,3,4,2))
        v_171 = v_170.contiguous(memory_format=torch.contiguous_format)
        v_172, v_173, v_174, v_175 = torch.split(tensor=v_171, dim=4, split_size_or_sections=(2,2,81,32))
        v_176 = F.sigmoid(input=v_172)
        v_177 = self.pnnx_fold_643_pnnx_fold_643
        v_178 = (((v_176 * 2) + v_143) * v_177)
        v_179 = F.sigmoid(input=v_173)
        v_180 = (torch.pow((v_179 * 2), 2) * v_142)
        v_181 = F.sigmoid(input=v_174)
        v_182 = torch.cat((v_178, v_180, v_181, v_175), dim=4)
        v_183 = self.model_24_m_2(v_139)
        v_184 = v_183.view(1, 3, 117, 20, 20)
        v_185 = torch.permute(input=v_184, dims=(0,1,3,4,2))
        v_186 = v_185.contiguous(memory_format=torch.contiguous_format)
        v_187, v_188, v_189, v_190 = torch.split(tensor=v_186, dim=4, split_size_or_sections=(2,2,81,32))
        v_191 = F.sigmoid(input=v_187)
        v_192 = self.pnnx_fold_682_pnnx_fold_682
        v_193 = (((v_191 * 2) + v_141) * v_192)
        v_194 = F.sigmoid(input=v_188)
        v_195 = (torch.pow((v_194 * 2), 2) * v_140)
        v_196 = F.sigmoid(input=v_189)
        v_197 = torch.cat((v_193, v_195, v_196, v_190), dim=4)
        v_198 = v_197.view(1, 1200, 117)
        v_199 = v_182.view(1, 4800, 117)
        v_200 = v_167.view(1, 19200, 117)
        v_201 = torch.cat((v_200, v_199, v_198), dim=1)
        v_202 = (v_201, v_152, )
        return v_202

def export_torchscript():
    net = Model()
    net.eval()

    torch.manual_seed(0)
    v_0 = torch.rand(1, 3, 640, 640, dtype=torch.float)

    mod = torch.jit.trace(net, v_0)
    mod.save("weights/segment/yolov5s-seg_pnnx.py.pt")

def export_onnx():
    net = Model()
    net.eval()

    torch.manual_seed(0)
    v_0 = torch.rand(1, 3, 640, 640, dtype=torch.float)

    torch.onnx._export(net, v_0, "weights/segment/yolov5s-seg_pnnx.py.onnx", export_params=True, operator_export_type=torch.onnx.OperatorExportTypes.ONNX_ATEN_FALLBACK, opset_version=13, input_names=['in0'], output_names=['out0'])

def test_inference():
    net = Model()
    net.eval()

    torch.manual_seed(0)
    v_0 = torch.rand(1, 3, 640, 640, dtype=torch.float)

    return net(v_0)
